TASK 5:Writing Join Queries, equivalent, and/or recursive queries:
(Tool: SQL/ Oracle, ALM: Flipped Classroom)

Aim: To Perform the advanced query processing and test its heuristics using designing of optimal correlated and nested sub queries such as finding summary statistics.
To retrieve all cricket boards and their teams.
To list all matches along with the teams and their captains.
To count the number of matches played by each team.
To find all the players who are part of the team named " TIGER ROCK ". 
To retrieve all team details, including the count of winning matches for each team.
To retrieve the total number of 'Tie' matches in a team-wise manner.
To retrieve the team details who won the matches.
To retrieve players and match details of players who are above 25 years old. 
To retrieve the details of Team who have not played any matches.
To retrieve the teamid, boardid, teamname, and playername for a particular playerid given.


To retrieve all cricket boards and their teams.

SQL> SELECT cb.Name AS CricketBoard, t.Name AS Team FROM CricketBoard cb JOIN Team t ON cb.BoardID = t.BoardID;

CricketBoard
Team

Chennai Cricket Board
ABS EXPRESS

Chennai Cricket Board
AVG EXPRESS

Tiruvallur Cricket Board
ANGRY BARD

Tiruvallur Cricket Board
TIGER ROCK

Trichy Cricket Board
ROCK

Viluppuram Cricket Board
RAINBOW

Madurai Cricket Board
PANTHER

Tuticorin Cricket Board
THUNDER

Selam Cricket Board
EAGLE

Tiruppur Cricket Board
KINGS


List all matches along with the teams and their captains.

SQL> SELECT m.match_Date, m.Time1, m.matchID, t1.name AS team1_name, t1.captain AS team1_captain, t2.name AS team2_name, t2.captain AS team2_captain FROM match m JOIN team t1 ON m.teamID = t1.teamID JOIN team t2 ON m.playerID = t2.teamID;

Match_Date
Time1
MatchID
team1_name
team1_captain
team2_name
team2_captain

22-JUN-2022
1.3
M01
ABS EXPRESS
SAMPATH KUMAR
ANGRY BARD
CINIL JOHN

22-JUN-2022
8.3
M02
AVG EXPRESS
Y.JOHN
TIGER ROCK
BEN GEORGE

24-JUN-2022
8.3
M03
ROCK
K.MUTHU
ANGRY BARD
CINIL JOHN

25-JUN-2022
8.3
M04
ROCK
K.MUTHU
TIGER ROCK
BEN GEORGE

04-APR-2023
7.3
M05
EAGLE
SRI HARI
AVG EXPRESS
Y.JOHN



Count the number of matches played each team.

SQL> SELECT t.Name AS Team, COUNT(mt.TeamID) AS MatchesPlayed FROM Team t LEFT JOIN Match mt ON t.TeamID = mt.TeamID GROUP BY t.Name;

Team
MatchesPlayed

ABS EXPRESS
1

ANGRY BARD
0

AVG EXPRESS
1

EAGLE
1

KINGS
0

PANTHER
0

RAINBOW
0

ROCK
2

THUNDER
0

TIGER ROCK
0



To find all the players who are part of the team named "TIGER ROCK".

SQL> SELECT p.playerID, p.fname, p.teamID, t.coach, t.captain FROM player p JOIN team t ON p.teamID = t.teamID WHERE t.name = 'TIGER ROCK';

PlayerID
FName
TeamID
Coach
Captain

102
Akash
TCB02
S.KANNAN
BEN GEORGE

12
Premkumar
TCB02
S.KANNAN
BEN GEORGE



To retrieve all team details, including the count of winning matches for each team.

SQL> SELECT t.TeamID, t.Name AS TeamName, t.Coach, t.Captain, COUNT(m.MatchID) AS WinningMatchCount FROM Team t LEFT JOIN Match m ON t.TeamID = substr(m.result,1,5) GROUP BY t.TeamID, t.Name, t.Coach, t.Captain;

Output:

TeamID
TeamName
Coach
Captain
WinningMatchCount

CCB01
ABS EXPRESS
G.D.RAMESH
SAMPATH KUMAR
1

CCB02
AVG EXPRESS
T.KARTHIK
Y.JOHN
0

MCB01
PANTHER
SARAVANAN
R.SUNILKUMAR
0

SCB01
EAGLE
SOMU
SRI HARI
0

TCB01
ANGRY BARD
TOM BABU
CINIL JOHN
2

TCB02
TIGER ROCK
S.KANNAN
BEN GEORGE
0

TICB01
KINGS
D ANAND
MATHAN
0

TRICB01
ROCK
K.PAUL
K.MUTHU
0

TUCB01
THUNDER
D ALEX
BARATHI
0

VCB01
RAINBOW
S.RAJESHKUMAR
MANIMARAN
0




5.6 To retrieve the total number of 'Tie' matches in a team-wise manner.

SQL> SELECT t.Name AS TeamName, COUNT(*) AS TotalTieMatches FROM Team t JOIN Match_result mt ON t.TeamID = mt.TeamID JOIN Match_result m ON mt.MatchID = m.MatchID WHERE m.Result = 'Tie' GROUP BY t.Name;

TeamName
TotalTieMatches

ROCK
1



5.7To retrieve the team details who won the matches.

SQL> select * from team where teamID in (select mr.teamID from match_result mr left join team t on mr.teamId=t.teamID where mr.result='Win');

TeamID
BoardID
Name
Coach
Captain

CCB01
BID01
ABS EXPRESS
G.D.RAMESH
SAMPATH KUMAR

TCB01
BID02
ANGRY BARD
TOM BABU
CINIL JOHN

TRICB01
BID04
ROCK
K.PAUL
K.MUTHU


To retrieve players and match details of players who are above 25 years old.

SQL> SELECT p.PlayerID, p.FName AS PlayerName, p.Age, m.MatchID, m.match_Date, m.Time1, m.Result FROM Player p, match m where p.playerID in(select playerID from player where age>25);

PlayerID
PlayerName
Age
MatchID
Match_Date
Time1
Result

1
Raj
27
M01
22-JUN-2022
1.3
TCB01 - WIN

1
Raj
27
M02
22-JUN-2022
8.3
CCB01 - WIN

1
Raj
27
M03
24-JUN-2022
8.3
TCB01 - WIN

1
Raj
27
M04
25-JUN-2022
8.3
TRICB01 - WIN

1
Raj
27
M05
04-APR-2023
7.3
Tie



To retrieve the details of Team who have not played any matches.

SQL> select * from team where teamID not in(select teamid from match Union select playerId from match);
TeamID
BoardID
Name
Coach
Captain

VCB01
BID03
RAINBOW
S.RAJESHKUMAR
MANIMARAN

MCB01
BID05
PANTHER
SARAVANAN
R.SUNILKUMAR

TUCB01
BID06
THUNDER
D ALEX
BARATHI

TICB01
BID08
KINGS
D ANAND
MATHAN


To retrieve the teamid, boardid, teamname, and playername for a particular playerid given.

SQL> SELECT t.teamid, t.boardid, t.name, p.fname FROM team t JOIN player p ON t.teamid = p.teamid WHERE p.playerid = '66';
TeamID
BoardID
Name
FName

VCB01
BID03
RAINBOW
Ganesh


Result:
Thus the query using Join Queries, equivalent, and/or recursive queries has been done successfully.
